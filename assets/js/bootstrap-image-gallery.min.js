!function(e){"use strict";var t=function(e,i,n){var o,a,s=document.createElement("img");if(s.onerror=i,s.onload=function(){!a||n&&n.noRevoke||t.revokeObjectURL(a),i&&i(t.scale(s,n))},t.isInstanceOf("Blob",e)||t.isInstanceOf("File",e))o=a=t.createObjectURL(e),s._type=e.type;else{if("string"!=typeof e)return!1;o=e,n&&n.crossOrigin&&(s.crossOrigin=n.crossOrigin)}return o?(s.src=o,s):t.readFile(e,function(e){var t=e.target;t&&t.result?s.src=t.result:i&&i(e)})},i=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;t.isInstanceOf=function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},t.transformCoordinates=function(e,t){var i=e.getContext("2d"),n=e.width,o=e.height;switch(t>4&&(e.width=o,e.height=n),t){case 2:i.translate(n,0),i.scale(-1,1);break;case 3:i.translate(n,o),i.rotate(Math.PI);break;case 4:i.translate(0,o),i.scale(1,-1);break;case 5:i.rotate(.5*Math.PI),i.scale(1,-1);break;case 6:i.rotate(.5*Math.PI),i.translate(0,-o);break;case 7:i.rotate(.5*Math.PI),i.translate(n,-o),i.scale(-1,1);break;case 8:i.rotate(-.5*Math.PI),i.translate(-n,0)}},t.renderImageToCanvas=function(e,t,i,n,o,a,s,l,r,d){return e.getContext("2d").drawImage(t,i,n,o,a,s,l,r,d),e},t.scale=function(e,i){i=i||{};var n,o,a,s,l,r,d,h=document.createElement("canvas"),c=e.getContext||(i.canvas||i.crop||i.orientation)&&h.getContext,g=e.width,m=e.height,f=g,u=m,w=0,p=0,v=0,y=0;return c&&i.orientation>4?(n=i.maxHeight,o=i.maxWidth,a=i.minHeight,s=i.minWidth):(n=i.maxWidth,o=i.maxHeight,a=i.minWidth,s=i.minHeight),c&&n&&o&&i.crop?(l=n,r=o,n/o>g/m?(u=o*g/n,p=(m-u)/2):(f=n*m/o,w=(g-f)/2)):(l=g,r=m,d=Math.max((a||l)/l,(s||r)/r),d>1&&(l=Math.ceil(l*d),r=Math.ceil(r*d)),d=Math.min((n||l)/l,(o||r)/r),1>d&&(l=Math.ceil(l*d),r=Math.ceil(r*d))),c?(h.width=l,h.height=r,t.transformCoordinates(h,i.orientation),t.renderImageToCanvas(h,e,w,p,f,u,v,y,l,r)):(e.width=l,e.height=r,e)},t.createObjectURL=function(e){return i?i.createObjectURL(e):!1},t.revokeObjectURL=function(e){return i?i.revokeObjectURL(e):!1},t.readFile=function(e,t,i){if(window.FileReader){var n=new FileReader;if(n.onload=n.onerror=t,i=i||"readAsDataURL",n[i])return n[i](e),n}return!1},"function"==typeof define&&define.amd?define(function(){return t}):e.loadImage=t}(this),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","load-image","bootstrap"],e):e(window.jQuery,window.loadImage)}(function(e,t){"use strict";e.extend(e.fn.modal.defaults,{delegate:document,selector:null,filter:"*",index:0,href:null,preloadRange:2,offsetWidth:100,offsetHeight:200,canvas:!1,slideshow:0,imageClickDivision:.5});var i=e.fn.modal.Constructor.prototype.show,n=e.fn.modal.Constructor.prototype.hide;e.extend(e.fn.modal.Constructor.prototype,{initLinks:function(){var t=this,i=this.options,n=i.selector||"a[data-target="+i.target+"]";this.$links=e(i.delegate).find(n).filter(i.filter).each(function(e){t.getUrl(this)===i.href&&(i.index=e)}),this.$links[i.index]||(i.index=0)},getUrl:function(t){return t.href||e(t).data("href")},getDownloadUrl:function(t){return e(t).data("download")},startSlideShow:function(){var e=this;this.options.slideshow&&(this._slideShow=window.setTimeout(function(){e.next()},this.options.slideshow))},stopSlideShow:function(){window.clearTimeout(this._slideShow)},toggleSlideShow:function(){var e=this.$element.find(".modal-slideshow");this.options.slideshow?(this.options.slideshow=0,this.stopSlideShow()):(this.options.slideshow=e.data("slideshow")||5e3,this.startSlideShow()),e.find("i").toggleClass("icon-play icon-pause")},preloadImages:function(){var t,i,n=this.options,o=n.index+n.preloadRange+1;for(i=n.index-n.preloadRange;o>i;i+=1)t=this.$links[i],t&&i!==n.index&&e("<img>").prop("src",this.getUrl(t))},loadImage:function(){var e,i=this,n=this.$element,o=this.options.index,a=this.getUrl(this.$links[o]),s=this.getDownloadUrl(this.$links[o]);this.abortLoad(),this.stopSlideShow(),n.trigger("beforeLoad"),this._loadingTimeout=window.setTimeout(function(){n.addClass("modal-loading")},100),e=n.find(".modal-image").children().removeClass("in"),window.setTimeout(function(){e.remove()},3e3),n.find(".modal-title").text(this.$links[o].title),n.find(".modal-download").prop("href",s||a),this._loadingImage=t(a,function(e){i.img=e,window.clearTimeout(i._loadingTimeout),n.removeClass("modal-loading"),n.trigger("load"),i.showImage(e),i.startSlideShow()},this._loadImageOptions),this.preloadImages()},showImage:function(t){var i,n,o=this.$element,a=e.support.transition&&o.hasClass("fade"),s=a?o.animate:o.css,l=o.find(".modal-image");l.css({width:t.width,height:t.height}),o.find(".modal-title").css({width:Math.max(t.width,380)}),a&&(i=o.clone().hide().appendTo(document.body)),e(window).width()>767?s.call(o.stop(),{"margin-top":-((i||o).outerHeight()/2),"margin-left":-((i||o).outerWidth()/2)}):o.css({top:(e(window).height()-(i||o).outerHeight())/2}),i&&i.remove(),l.append(t),n=t.offsetWidth,o.trigger("display"),a?o.is(":visible")?e(t).on(e.support.transition.end,function(i){i.target===t&&(e(t).off(e.support.transition.end),o.trigger("displayed"))}).addClass("in"):(e(t).addClass("in"),o.one("shown",function(){o.trigger("displayed")})):(e(t).addClass("in"),o.trigger("displayed"))},abortLoad:function(){this._loadingImage&&(this._loadingImage.onload=this._loadingImage.onerror=null),window.clearTimeout(this._loadingTimeout)},prev:function(){var e=this.options;e.index-=1,e.index<0&&(e.index=this.$links.length-1),this.loadImage()},next:function(){var e=this.options;e.index+=1,e.index>this.$links.length-1&&(e.index=0),this.loadImage()},keyHandler:function(e){switch(e.which){case 37:case 38:e.preventDefault(),this.prev();break;case 39:case 40:e.preventDefault(),this.next()}},wheelHandler:function(e){e.preventDefault(),e=e.originalEvent,this._wheelCounter=this._wheelCounter||0,this._wheelCounter+=e.wheelDelta||e.detail||0,e.wheelDelta&&this._wheelCounter>=120||!e.wheelDelta&&this._wheelCounter<0?(this.prev(),this._wheelCounter=0):(e.wheelDelta&&this._wheelCounter<=-120||!e.wheelDelta&&this._wheelCounter>0)&&(this.next(),this._wheelCounter=0)},initGalleryEvents:function(){var t=this,i=this.$element;i.find(".modal-image").on("click.modal-gallery",function(i){var n=e(this);1===t.$links.length?t.hide():(i.pageX-n.offset().left)/n.width()<t.options.imageClickDivision?t.prev(i):t.next(i)}),i.find(".modal-prev").on("click.modal-gallery",function(e){t.prev(e)}),i.find(".modal-next").on("click.modal-gallery",function(e){t.next(e)}),i.find(".modal-slideshow").on("click.modal-gallery",function(e){t.toggleSlideShow(e)}),e(document).on("keydown.modal-gallery",function(e){t.keyHandler(e)}).on("mousewheel.modal-gallery, DOMMouseScroll.modal-gallery",function(e){t.wheelHandler(e)})},destroyGalleryEvents:function(){var t=this.$element;this.abortLoad(),this.stopSlideShow(),t.find(".modal-image, .modal-prev, .modal-next, .modal-slideshow").off("click.modal-gallery"),e(document).off("keydown.modal-gallery").off("mousewheel.modal-gallery, DOMMouseScroll.modal-gallery")},show:function(){if(!this.isShown&&this.$element.hasClass("modal-gallery")){var t=this.$element,n=this.options,o=e(window).width(),a=e(window).height();t.hasClass("modal-fullscreen")?(this._loadImageOptions={maxWidth:o,maxHeight:a,canvas:n.canvas},t.hasClass("modal-fullscreen-stretch")&&(this._loadImageOptions.minWidth=o,this._loadImageOptions.minHeight=a)):this._loadImageOptions={maxWidth:o-n.offsetWidth,maxHeight:a-n.offsetHeight,canvas:n.canvas},o>767?t.css({"margin-top":-(t.outerHeight()/2),"margin-left":-(t.outerWidth()/2)}):t.css({top:(e(window).height()-t.outerHeight())/2}),this.initGalleryEvents(),this.initLinks(),this.$links.length&&(t.find(".modal-slideshow, .modal-prev, .modal-next").toggle(1!==this.$links.length),t.toggleClass("modal-single",1===this.$links.length),this.loadImage())}i.apply(this,arguments)},hide:function(){this.isShown&&this.$element.hasClass("modal-gallery")&&(this.options.delegate=document,this.options.href=null,this.destroyGalleryEvents()),n.apply(this,arguments)}}),e(function(){e(document.body).on("click.modal-gallery.data-api",'[data-toggle="modal-gallery"]',function(t){var i,n=e(this),o=n.data(),a=e(o.target),s=a.data("modal");s||(o=e.extend(a.data(),o)),o.selector||(o.selector="a[data-gallery=gallery]"),i=e(t.target).closest(o.selector),i.length&&a.length&&(t.preventDefault(),o.href=i.prop("href")||i.data("href"),o.delegate=i[0]!==this?this:document,s&&e.extend(s.options,o),a.modal(o))})})});